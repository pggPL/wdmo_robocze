% Rozdział 14 – twierdzenia z teorii liczb

\theory{Twierdzenia z teorii liczb}

\noindent
Na potrzeby następujących: lematu i twierdzenia, dla liczby całkowitej $n$ oraz parami względnie pierwszych liczb $m_1$, ..., $m_k$ przyjmiemy
\[
	G(n) = (n \;(\text{mod } m_1),\; n \;(\text{mod } m_2),\; ...,\; n \;(\text{mod } m_k)).
\]
Chociażby dla $n = 25$ i $m_1 = 2$, $m_2 = 3$ i $m_3 = 7$ mamy
\[
	G(25) = (25 \;(\text{mod } 2),\; 25 \;(\text{mod } 3),\; 25 \;(\text{mod } 7)) = (1, 1, 4).
\]
Zauważmy, że $G(n)$ na $i$-tej pozycji może przyjąć $m_i$ wartości. A więc łącznie $G(n)$ może przyjąć $m_1m_2\cdot...\cdot m_k$ wartości.

\vspace{10px}

\heading{Lemat 1}

\noindent
Dane są parami względnie pierwsze liczby $m_1$, ..., $m_k$ oraz dodatnie liczby całkowite~$x$,~$y$ spełniające $m_1m_2\cdot ... \cdot m_k > x > y \geqslant 0$. Wykazać, że wówczas
\[
	G(x) \neq G(y).
\]

\heading{Dowód}

\noindent
Załóżmy nie wprost, że $G(x) = G(y)$. Znaczy to tyle, że dla każdej liczby $i \in \{1, 2, ..., k\}$ zachodzi przystawanie
\[
	x \equiv y \pmod{m_i},
\]
czyli równoważnie liczba $x - y$ jest podzielna przez $m_i$. Skoro $m_i$ są parami względnie pierwsze, to liczba $x - y$ jest podzielna przez $m_1m_2 \cdot ... \cdot m_k$. Z założeń zadania mamy zaś, że
\[
	m_1m_2 \cdot ... \cdot m_k > x - y > 0,
\]
co daje sprzeczność z wyżej otrzymaną podzielnością.

\qed

\vspace{10px}

\heading{Chińskie twierdzenie o resztach}

\noindent
Dane są parami względnie pierwsze liczby $m_1$, ..., $m_k$ oraz  liczby całkowite $a_1$, ..., $a_k$. Wówczas istnieje taka liczba całkowita $x$, że zachodzą przystawania
\begin{gather*}
	x \equiv a_1 \pmod{m_1}, \\
	x \equiv a_2 \pmod{m_2}, \\
	..., \\
	x \equiv a_k \pmod{m_k}.
\end{gather*}

\heading{Dowód}

\noindent
Dla liczb $m_1$, ..., $m_k$ rozpatrzmy krotki
\[
	G(0),\; G(1),\; G(2),\; ...,\; G(m_1 \cdot ...\cdot m_k - 1).
\]
Powyższych liczb jest $m_1 \cdot ...\cdot m_k$. Wiemy, że $G(n)$ może przyjmować $m_1 \cdot ...\cdot m_k$ parami różnych wartości. Skoro na mocy Lematu 1 powyższe krotki są parami różne, to występuje tam po jednej krotce każdego z dostępnych rodzajów. Stąd też w szczególności istnieje krotka, która spełnia warunki narzucone przez liczby $a_1$, ..., $a_k$.

\qed
\vspace{5px}

\noindent
Powyższe twierdzenie innymi słowami znaczy to, że jeśli narzucimy na pewną liczbę warunki przystawania modulo, które nie są ze sobą sprzeczne, to istnieje liczba, która je spełnia. Dla przykładu warunki
\begin{align*}
	x &\equiv 2 \pmod{3}, \\
	x &\equiv 1 \pmod{5}, \\
	x &\equiv 5 \pmod{14}.
\end{align*}
są spełniane przez liczbę $131$.

\vspace{10px}

\noindent
Względna pierwszość liczb $m_1$, $m_2$, ..., $m_k$ zapewnia nas o tym, że nie zajdzie żadna sprzeczność w przystawaniach. Aby się przekonać, że bez powyższego założenia teza twierdzenia nie zajdzie, zauważmy, że nie istnieje liczba, która spełnia warunki
\begin{gather*}
	x \equiv 1 \pmod{2}, \\
	x \equiv 4 \pmod{6}.
\end{gather*}
Z pierwszego przystawania wynika jej parzystość, a z drugiego jej nieparzystość.

\vspace{10px}

\heading{Twierdzenie 2}

\noindent
Dana jest liczba pierwsza $p$. Wówczas istnieje taka liczba $g \in \{1, 2, 3, ..., p - 1\}$, że liczby 
\[
	g,\; g^2,\; g^3,\; ...,\; g^{p - 1}
\]
dają parami różne reszty modulo $p$.

\vspace{20px}

\noindent
Innymi słowy reszty z dzielenia powyższych liczb są pewną permutacją reszt
\[
	1,\; 2,\; 3,\; ...,\;  p - 1.
\]
Czyli dla dowolniej niezerowej reszty $a$, istnieje taka liczba naturalna $k$, że 
\[
	a \equiv g^k \pmod{p}.
\]
Liczbę $g$ nazwiemy \textit{generatorem} lub \textit{pierwiastkiem pierwotnym} modulo $p$. Dowód powyższego twierdzenia pominiemy.

\vspace{10px}

\noindent
Przykładem generatora dla $p = 11$ jest $g = 6$. Istotnie
\begin{gather*}
	6^1 \equiv 6, \;\; 6^2 \equiv 3, \;\; 6^3 \equiv 7, \;\;
	6^4 \equiv 9, \;\; 6^5 \equiv 10, \pmod{11} \\
	 6^6 \equiv 5, \;\;
	6^7 \equiv 8, \;\; 6^8 \equiv 4, \;\; 6^9 \equiv 2, \;\; 6^{10} \equiv 1 \pmod{11},
\end{gather*}
liczba $6$ wygenerowała wszystkie niezerowe reszty modulo $11$.

\newpage

\heading{Symbol Legendre'a}

\noindent
Dla pewnej liczby pierwszej $p$ oraz liczby całkowitej $n$ przyjmiemy
\[
	\left(\frac{n}{p}\right) = 
	\begin{cases}
		\phantom{-}1 \text{, gdy istnieje taka liczba całkowita } a \not\equiv 0 \text{, że } n \equiv a^2 \pmod{p}\\
		-1\text{, gdy nie istnieje taka liczba całkowita } a \not\equiv 0 \text{, że } n \equiv a^2 \pmod{p} \\
		\phantom{-}0 \text{, gdy } n \equiv 0 \pmod{p}\\
	\end{cases}
\]

\noindent
W pierwszym przypadku powiemy, że $n$ jest \textit{resztą kwadratową}, a w drugim, że $n$ jest \textit{nieresztą kwadratową}.

\vspace{10px}
\noindent
Znanym faktem jest, że $\left(\frac{1}{3}\right) = 1$ oraz $\left(\frac{2}{3}\right) = -1$.

\vspace{10px}

\heading{Lemat 2}

\noindent
Niech $g$ będzie generatorem dla pewnej nieparzystej liczby pierwszej $p$ oraz dla pewnych liczb naturalnych $n$, $k$ zachodzi przystawanie
\[
	n \equiv g^k \pmod{p}
\] 
Wówczas $n$ jest resztą kwadratową modulo $p$ wtedy i tylko wtedy, gdy $2 \mid k$.

\vspace{5px}

\heading{Dowód}

\noindent
Załóżmy, że zachodzą przystawania
\[
	n \equiv a^2 \pmod{p}, \quad a \equiv g^l \pmod{p}.
\]
Wówczas
\[
	n \equiv g^{2l} \pmod{p},
\]
czyli $k \equiv 2l \pmod{p - 1}$. Skoro zarówno $2l$, jak i $p - 1$ są parzyste, to $k$ również jest liczbą parzystą.

\vspace{10px}
\noindent
W drugą stronę, jeśli
\[
	n \equiv g^{2l} \pmod{p},
\]
to biorąc $a \equiv g^k \pmod{p}$ otrzymamy tezę.

\qed
\vspace{10px}

\heading{Twierdzenie 3}

\noindent
Dana jest liczba pierwsza $p$ oraz liczby całkowite $a$, $b$. Wówczas zachodzi równość
\[
	\left(\frac{a}{p}\right)\left(\frac{b}{p}\right) = \left(\frac{ab}{p}\right).
\]

\heading{Dowód}

\noindent
Jeśli $\left(\frac{a}{p}\right) = 0$, to liczba $a$ jest podzielna przez $p$. Wówczas liczba $ab$ też będzie podzielna przez $p$, czyli $\left(\frac{ab}{p}\right) = 0$. W dalszej części rozwiązania zakładam, że żadna z liczb $a$, $b$, nie jest podzielna przez $p$.

\noindent
Zapiszmy
\[
	a \equiv g^k \pmod{p} \quad b \equiv g^l \pmod{p} \quad ab \equiv g^k \cdot g^l = g^{k + l} \pmod{p}
\]
dla pewnego generatora $g$. Wówczas, na mocy Lematu 2, teza sprowadza się do tego, że liczba $k + l$ będzie nieparzysta wtedy i tylko wtedy, gdy dokładnie jedna spośród liczb~$k$,~$l$ będzie nieparzysta. A to jest oczywiście prawda.

\qed

\vspace{10px}

\heading{Przykład 1}

\noindent
Wykazać, że dla dodatniej liczby całkowitej $k$, która nie jest podzielna przez $p - 1$ zachodzi przystawanie
\[
	1^k + 2^k + 3^k + ... + p^k \equiv 0 \pmod{p}.
\]

\vspace{10px}

\heading{Rozwiązanie}

\noindent
Rozpatrzmy generator $g$ modulo $p$. Wówczas reszty z dzielenia przez $p$ liczb
\[
	g,\; g^2,\; g^3,\; ...,\; g^{p - 1}
\]
są pewną permutacją reszt
\[
	1,\; 2,\; 3,\; ...,\;  p - 1.
\]
Stąd reszty z dzielenia przez $p$ liczb
\[
	g^k,\; g^{2k},\; g^{3k},\; ...,\; g^{k(p - 1)}
\]
to pewna permutacja liczb
\[
	1^k,\; 2^k,\; 3^k,\; ...,\;  (p - 1)^k.
\]
Skoro to są te same reszty, tylko w innej kolejności, to ich sumy muszą być sobie równe
\[
	1^k + 2^k + 3^k + ... + p^k \equiv g^k + g^{2k} + g^{3k} +  ... + g^{k(p - 1)} \equiv g^k \cdot \frac{g^{k(p - 1)} - 1}{g^k - 1} \pmod{p}.
\]
Z Małego Twierdzenie Fermata mamy
\[
	g^{k(p - 1)} - 1 \equiv \left(g^{k}\right)^{p - 1} - 1 \equiv 0 \pmod{p}. 
\]
Skoro $p - 1 \nmid k$, to $g^k \not\equiv 1 \pmod{p}$. Mamy więc, że
\[
	g^k \cdot \frac{g^{k(p - 1)} - 1}{g^k - 1} \equiv 0 \pmod{p}.
\]
\qed
